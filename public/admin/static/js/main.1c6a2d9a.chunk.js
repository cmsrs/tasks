(this["webpackJsonptasks-react"]=this["webpackJsonptasks-react"]||[]).push([[0],{236:function(e,t,a){},237:function(e,t,a){"use strict";a.r(t);var s={};a.r(s),a.d(s,"signin",(function(){return q})),a.d(s,"signout",(function(){return E}));var n={};a.r(n),a.d(n,"getProjects",(function(){return V})),a.d(n,"saveProject",(function(){return X})),a.d(n,"saveTask",(function(){return Y})),a.d(n,"deleteProject",(function(){return Z})),a.d(n,"deleteTask",(function(){return $}));var r=a(2),c=a(0),o=a.n(c),i=a(51),p=a.n(i),l=a(53),u=a(8),d=a(9),j=a(10),h=a(7),m=a(107),b=a(240),f="auth_user",v="auth_error",g="projects_get_projects",O="projects_res",k="users_get_clients",y="users_res",x={authenticated:"",errorMessage:""};var w={projects:[]};var _={users:[]};var N=Object(h.combineReducers)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(d.a)(Object(d.a)({},e),{},{authenticated:t.payload});case v:return Object(d.a)(Object(d.a)({},e),{},{errorMessage:t.payload});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(d.a)(Object(d.a)({},e),{},{users_res:t.payload});case k:var a=Object(d.a)(Object(d.a)({},e),{},{clients:t.payload});return a;default:return e}},projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(d.a)(Object(d.a)({},e),{},{projects_res:t.payload});case g:var a=Object(d.a)(Object(d.a)({},e),{},{projects:t.payload,projects_res:{}});return a;default:return e}},form:b.a}),P=a(109),S=function(e){var t=e.children,a=e.initialState,s=void 0===a?{}:a,n=Object(h.createStore)(N,Object(d.a)({auth:{authenticated:localStorage.getItem("token")}},s),Object(m.composeWithDevTools)(Object(h.applyMiddleware)(P.a)));return Object(r.jsx)(j.a,{store:n,children:t})},C=function(e){var t=e.children;return Object(r.jsx)("div",{children:t})},T=a(17),I=a(18),R=a(20),D=a(19),A=a(13),M=a.n(A),U=a(30),W=a(25),J=a.n(W),L="http://127.0.0.1:8000",q=function(e,t){return function(){var a=Object(U.a)(M.a.mark((function a(s){var n;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,J.a.post(L+"/api/login",e);case 3:n=a.sent,s({type:f,payload:n.data.data.token}),localStorage.setItem("token",n.data.data.token),t(),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),s({type:v,payload:"Invalid login credentials"});case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}()},E=function(e){return function(t){localStorage.removeItem("token"),t({type:f,payload:""}),e()}},z=function(e){Object(R.a)(a,e);var t=Object(D.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.signout((function(){e.props.history.push("/admin/")}))}},{key:"render",value:function(){return Object(r.jsx)("div",{children:"Sorry to see you go"})}}]),a}(c.Component),B=Object(j.b)(null,s)(z),F=a(239),G=a(238),H=function(e){Object(R.a)(a,e);var t=Object(D.a)(a);function a(){var e;Object(T.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).onSubmit=function(t){e.props.signin(t,(function(){return e.props.history.push("/admin/projects")}))},e}return Object(I.a)(a,[{key:"componentDidMount",value:function(){if(this.props.auth){this.props.history.push("/admin/projects")}}},{key:"render",value:function(){var e=this.props.handleSubmit;return Object(r.jsxs)("form",{className:"container mt-4",onSubmit:e(this.onSubmit),children:[Object(r.jsxs)("fieldset",{className:"col-4 form-group",children:[Object(r.jsx)("label",{children:"Email"}),Object(r.jsx)(F.a,{className:"form-control  mb-2",name:"email",type:"text",component:"input",autoComplete:"none"})]}),Object(r.jsxs)("fieldset",{className:"col-4  form-group",children:[Object(r.jsx)("label",{children:"Password"}),Object(r.jsx)(F.a,{className:"form-control  mb-2",name:"password",type:"password",component:"input",autoComplete:"none"})]}),Object(r.jsx)("div",{children:this.props.errorMessage}),Object(r.jsx)("button",{className:"btn btn-primary mt-2 mr-sm-2",children:"Sign In!"})]})}}]),a}(c.Component);var K=Object(h.compose)(Object(j.b)((function(e){return{errorMessage:e.auth.errorMessage,auth:e.auth.authenticated}}),s),Object(G.a)({form:"signin"}))(H),Q=a(26),V=function(e){return function(){var t=Object(U.a)(M.a.mark((function t(a){var s,n;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=localStorage.getItem("token"),t.prev=1,t.next=4,J.a.get(L+"/api/projects?token="+s);case 4:(n=t.sent).data.success?(a({type:g,payload:n.data.data}),e(n.data.data)):a({type:O,payload:{success:!1,message:"Unknown problem with ajax, while get projects 0"}}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),a({type:O,payload:{success:!1,message:"Unknown problem with ajax, while get projects"}});case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},X=function(e,t){return function(){var a=Object(U.a)(M.a.mark((function a(s){var n,r;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=localStorage.getItem("token"),a.prev=1,r=null,!e.id){a.next=9;break}return a.next=6,J.a.put(L+"/api/projects/"+e.id+"?token="+n,e);case 6:r=a.sent,a.next=12;break;case 9:return a.next=11,J.a.post(L+"/api/projects?token="+n,e);case 11:r=a.sent;case 12:r.data.success?(s({type:O,payload:{success:!0,message:"Data was saved"}}),t()):s({type:O,payload:{success:!1,message:r.data.error}}),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(1),console.log("___probem with ajax______",a.t0),s({type:O,payload:{success:!1,message:"Unknown problem with ajax, while save pproject"}});case 19:case"end":return a.stop()}}),a,null,[[1,15]])})));return function(e){return a.apply(this,arguments)}}()},Y=function(e,t){return function(){var a=Object(U.a)(M.a.mark((function a(s){var n,r;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=localStorage.getItem("token"),a.prev=1,r=null,!e.id){a.next=9;break}return a.next=6,J.a.put(L+"/api/tasks/"+e.id+"?token="+n,e);case 6:r=a.sent,a.next=12;break;case 9:return a.next=11,J.a.post(L+"/api/tasks?token="+n,e);case 11:r=a.sent;case 12:r.data.success?(s({type:O,payload:{success:!0,message:"Data was saved"}}),t()):s({type:O,payload:{success:!1,message:r.data.error}}),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(1),console.log("___probem with ajax______",a.t0),s({type:O,payload:{success:!1,message:"Unknown problem with ajax, while save task"}});case 19:case"end":return a.stop()}}),a,null,[[1,15]])})));return function(e){return a.apply(this,arguments)}}()},Z=function(e,t){return function(){var a=Object(U.a)(M.a.mark((function a(s){var n,r;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=localStorage.getItem("token"),a.prev=1,a.next=4,J.a.delete(L+"/api/projects/"+e+"?token="+n);case 4:(r=a.sent).data.success?(s({type:O,payload:{success:!0,message:"Data was saved"}}),t()):s({type:O,payload:{success:!1,message:r.data.error}}),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),s({type:O,payload:{success:!1,message:"Unknown problem with ajax, while deleteing proj"}});case 11:case"end":return a.stop()}}),a,null,[[1,8]])})));return function(e){return a.apply(this,arguments)}}()},$=function(e,t){return function(){var a=Object(U.a)(M.a.mark((function a(s){var n,r;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=localStorage.getItem("token"),a.prev=1,a.next=4,J.a.delete(L+"/api/tasks/"+e+"?token="+n);case 4:(r=a.sent).data.success?(s({type:O,payload:{success:!0,message:"Data was saved"}}),t()):s({type:O,payload:{success:!1,message:r.data.error}}),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),s({type:O,payload:{success:!1,message:"Unknown problem with ajax, while deleteing task"}});case 11:case"end":return a.stop()}}),a,null,[[1,8]])})));return function(e){return a.apply(this,arguments)}}()},ee=function(e){Object(R.a)(a,e);var t=Object(D.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"renderLinks",value:function(){if(this.props.authenticated)return Object(r.jsxs)("div",{className:"container-fluid",children:[Object(r.jsx)("div",{className:"container",children:"Projects"}),Object(r.jsx)(l.b,{to:"/admin/signout",children:"Sign Out"})]})}},{key:"render",value:function(){return Object(r.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:this.renderLinks()})}}]),a}(c.Component);var te=Object(j.b)((function(e){return{authenticated:e.auth.authenticated}}))(ee),ae=function(e){Object(R.a)(a,e);var t=Object(D.a)(a);function a(e){var s;return Object(T.a)(this,a),(s=t.call(this,e)).state={visible:!0},s}return Object(I.a)(a,[{key:"componentWillReceiveProps",value:function(e){e.children!==this.props.children&&(this.setTimer(),this.setState({visible:!0}))}},{key:"componentDidMount",value:function(){this.setTimer()}},{key:"setTimer",value:function(){null!=this._timer&&clearTimeout(this._timer),this._timer=setTimeout(function(){this.setState({visible:!1}),this._timer=null}.bind(this),this.props.delay)}},{key:"componentWillUnmount",value:function(){clearTimeout(this._timer)}},{key:"render",value:function(){return this.state.visible?Object(r.jsx)("div",{children:this.props.children}):Object(r.jsx)("span",{})}}]),a}(o.a.Component),se=(a(236),function(e){Object(R.a)(a,e);var t=Object(D.a)(a);function a(e){var s;return Object(T.a)(this,a),(s=t.call(this,e)).handleAddProject=function(){var e=s.state.projTitle;s.props.saveProject({title:e},(function(){s.props.getProjects((function(e){s.setState({projects:e}),e.length&&!s.state.taskProjectId&&s.setState({taskProjectId:e[0].id})}))})),s.setState({projTitle:""})},s.handleChangeTitle=function(e){var t=e.target.value;s.setState({projTitle:t})},s.handleChangeTitleShow=function(e){var t,a=e.target.value,n=parseInt(e.target.attributes.getNamedItem("data-projectid").value.replace(/^\D+/g,"")),r=[],c=Object(Q.a)(s.state.projects);try{for(c.s();!(t=c.n()).done;){var o=t.value,i=Object.assign({},o);o.id===n&&(i.title=a),r.push(i)}}catch(p){c.e(p)}finally{c.f()}s.setState({projects:r})},s.handleAddTask=function(){var e={name:s.state.taskName,points:s.state.taskPoints,project_id:s.state.taskProjectId?s.state.taskProjectId:s.state.projects?s.state.projects[0].id:""};s.props.saveTask(e,(function(){s.props.getProjects((function(e){s.setState({projects:e})}))})),s.setState({taskName:"",taskPoints:""})},s.handleChangeName=function(e){var t=e.target.value;s.setState({taskName:t})},s.handleChangePoints=function(e){var t=e.target.value;s.setState({taskPoints:t})},s.handleChangeNameShow=function(e){var t,a=e.target.value,n=parseInt(e.target.attributes.getNamedItem("data-projectid").value.replace(/^\D+/g,"")),r=parseInt(e.target.attributes.getNamedItem("data-taskid").value.replace(/^\D+/g,"")),c=[],o=Object(Q.a)(s.state.projects);try{for(o.s();!(t=o.n()).done;){var i=t.value,p=Object.assign({},i);if(i.id===n){var l,u=[],d=Object(Q.a)(i.tasks);try{for(d.s();!(l=d.n()).done;){var j=l.value,h=Object.assign({},j);j.id===r&&(h.name=a),u.push(h)}}catch(m){d.e(m)}finally{d.f()}p.tasks=u}c.push(p)}}catch(m){o.e(m)}finally{o.f()}s.setState({projects:c})},s.handleChangePointsShow=function(e){var t,a=e.target.value,n=parseInt(e.target.attributes.getNamedItem("data-projectid").value.replace(/^\D+/g,"")),r=parseInt(e.target.attributes.getNamedItem("data-taskid").value.replace(/^\D+/g,"")),c=[],o=Object(Q.a)(s.state.projects);try{for(o.s();!(t=o.n()).done;){var i=t.value,p=Object.assign({},i);if(i.id===n){var l,u=[],d=Object(Q.a)(i.tasks);try{for(d.s();!(l=d.n()).done;){var j=l.value,h=Object.assign({},j);j.id===r&&(h.points=a),u.push(h)}}catch(m){d.e(m)}finally{d.f()}p.tasks=u}c.push(p)}}catch(m){o.e(m)}finally{o.f()}s.setState({projects:c})},s.handleChangeProjectId=function(e){var t=e.target.value;s.setState({taskProjectId:t})},s.editProj=function(e){var t,a="",n=Object(Q.a)(s.state.projects);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.id===e){a={id:r.id,title:r.title};break}}}catch(c){n.e(c)}finally{n.f()}a&&s.props.saveProject(a,(function(){s.props.getProjects((function(e){s.setState({projects:e})}))}))},s.delProj=function(e){s.props.deleteProject(e,(function(){s.props.getProjects((function(e){s.setState({projects:e})}))}))},s.delTask=function(e){s.props.deleteTask(e,(function(){s.props.getProjects((function(e){s.setState({projects:e})}))}))},s.editTask=function(e){var t,a="",n=Object(Q.a)(s.state.projects);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,o=Object(Q.a)(c.tasks);try{for(o.s();!(r=o.n()).done;){var i=r.value;i.id===e&&(a={id:i.id,name:i.name,points:i.points,project_id:i.project_id})}}catch(p){o.e(p)}finally{o.f()}}}catch(p){n.e(p)}finally{n.f()}a&&s.props.saveTask(a,(function(){s.props.getProjects((function(e){s.setState({projects:e})}))}))},s.state={projTitle:"",taskName:"",taskPoints:"",taskProjectId:"",projects:{}},s.props.getProjects((function(e){s.setState({projects:e})})),s}return Object(I.a)(a,[{key:"render",value:function(){var e=this,t=this.state.projects,a="";if(this.props.projectsRes&&!1===this.props.projectsRes.success){var s="";if("object"!==typeof this.props.projectsRes.message&&"function"!==typeof this.props.projectsRes.message||null===this.props.projectsRes.message)if(Array.isArray(this.props.projectsRes.message))for(var n in this.props.projectsRes.message)s+=n+": "+this.props.projectsRes.message[n][0]+"  ";else s=this.props.projectsRes.message;else for(var c in this.props.projectsRes.message)s+=this.props.projectsRes.message[c][0]+" ";a=Object(r.jsx)(ae,{delay:9e3,children:Object(r.jsx)("div",{className:"alert alert-danger mb-4",role:"alert",children:s})})}return this.props.projectsRes&&!0===this.props.projectsRes.success&&(a=Object(r.jsx)(ae,{delay:9e4,children:Object(r.jsx)("div",{className:"alert alert-success  mb-4",role:"alert",children:this.props.projectsRes.message})})),Object(r.jsxs)("div",{children:[Object(r.jsx)(te,{}),Object(r.jsxs)("div",{className:"mt-3  container",children:[Object(r.jsx)("h2",{className:"mb-3",children:"Projects and tasks"}),Object(r.jsx)("div",{className:"wrapMsg",children:a}),Object(r.jsxs)("div",{className:"row mt-4",children:[Object(r.jsx)("input",{type:"text",placeholder:"Project title",name:"title",className:"mr-2",onChange:this.handleChangeTitle,value:this.state.projTitle},"title"),Object(r.jsx)("button",{className:"btn btn-primary mt-2 mb-2",onClick:this.handleAddProject,children:"Add project"})]}),!!t.length&&Object(r.jsxs)("div",{className:"row mt-3",children:[Object(r.jsx)("input",{type:"text",placeholder:"Task name",name:"name",className:"mr-2",onChange:this.handleChangeName,value:this.state.taskName},"name"),Object(r.jsx)("input",{type:"text",placeholder:"Task points",name:"points",className:"mr-2",onChange:this.handleChangePoints,value:this.state.taskPoints},"points"),Object(r.jsx)("select",{name:"project_id",onChange:this.handleChangeProjectId,className:"mr-2",value:this.state.taskProjectId,children:t.map((function(e){return Object(r.jsx)("option",{value:e.id||"",children:e.title||""},e.id)}))}),Object(r.jsx)("button",{id:"add_menu",className:"btn btn-primary mt-2 mb-2",onClick:this.handleAddTask,children:"Add task"})]}),Object(r.jsx)("div",{className:"row mt-3",children:!!t.length&&t.map((function(t){return Object(r.jsxs)("div",{className:"mt-3  container",children:[Object(r.jsx)("input",{type:"text","data-projectid":"project_id_"+t.id,placeholder:"Project title",name:"title",className:"m-2",onChange:e.handleChangeTitleShow,value:t.title},"proj_"+t.id),Object(r.jsx)("span",{onClick:e.editProj.bind(e,t.id),children:Object(r.jsx)("i",{className:"m-1 far fa-edit cursor-pointer"})}),Object(r.jsx)("span",{onClick:e.delProj.bind(e,t.id),children:Object(r.jsx)("i",{className:"m-1 fas fa-trash cursor-pointer","aria-hidden":"true"})}),Object(r.jsx)("ul",{children:t.tasks.map((function(a){return Object(r.jsxs)("li",{children:[Object(r.jsx)("input",{type:"text","data-projectid":"project_id_"+t.id,"data-taskid":"task_id_"+a.id,placeholder:"Task name",name:"name",className:"m-1",onChange:e.handleChangeNameShow,value:a.name},"name"),Object(r.jsx)("input",{type:"text","data-projectid":"project_id_"+t.id,"data-taskid":"task_id_"+a.id,placeholder:"Task points",name:"points",className:"m-1",onChange:e.handleChangePointsShow,value:a.points},"points"),Object(r.jsx)("span",{onClick:e.editTask.bind(e,a.id),children:Object(r.jsx)("i",{className:"m-1 far fa-edit cursor-pointer"})}),Object(r.jsx)("span",{onClick:e.delTask.bind(e,a.id),children:Object(r.jsx)("i",{className:"m-1 fas fa-trash cursor-pointer","aria-hidden":"true"})})]},"wrap_task_"+t.id+"_"+a.id)}))})]},"wrap_"+t.id)}))})]})]})}}]),a}(c.Component));var ne=Object(j.b)((function(e){return{projects:e.projects.projects,projectsRes:e.projects.projects_res}}),n)(function(e){var t=function(t){Object(R.a)(s,t);var a=Object(D.a)(s);function s(){return Object(T.a)(this,s),a.apply(this,arguments)}return Object(I.a)(s,[{key:"componentDidMount",value:function(){this.shouldNavigateAway()}},{key:"componentDidUpdate",value:function(){this.shouldNavigateAway()}},{key:"shouldNavigateAway",value:function(){if(!this.props.auth){this.props.history.push("/admin/")}}},{key:"render",value:function(){return Object(r.jsx)(e,Object(d.a)({},this.props))}}]),s}(c.Component);return Object(j.b)((function(e){return{auth:e.auth.authenticated}}))(t)}(se));p.a.render(Object(r.jsx)(S,{children:Object(r.jsx)(l.a,{children:Object(r.jsxs)(C,{children:[Object(r.jsx)(u.a,{path:"/admin",exact:!0,component:K}),Object(r.jsx)(u.a,{path:"/admin/signout",component:B}),Object(r.jsx)(u.a,{path:"/admin/signin",component:K}),Object(r.jsx)(u.a,{path:"/admin/projects",component:ne})]})})}),document.querySelector("#root"))}},[[237,1,2]]]);
//# sourceMappingURL=main.1c6a2d9a.chunk.js.map